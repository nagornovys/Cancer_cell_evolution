<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>tugHall version 1.1: USER-GUIDE-tugHall</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">tugHall version 1.1: USER-GUIDE-tugHall</h1>



<div id="requirements-for-tughall-simulation" class="section level2">
<h2>Requirements for tugHall simulation:</h2>
<p>R version <strong>3.3</strong> or later</p>
<p>libraries: <strong>stringr</strong></p>
<p>Note that the program has two different procedures in general: the first is the simulation and the second is the analysis of the simulation results. Please, pay attention that the requirements for these procedures are <strong>different</strong>. This User-Guide pertains to the <strong>simulation procedure</strong> alone.</p>
<p><br /></p>
</div>
<div id="table-of-contents" class="section level1">
<h1>Table of Contents</h1>
<ol style="list-style-type: decimal">
<li><a href="#quick">Quick start guide</a></li>
<li><a href="#directories">Structure of directories</a></li>
<li><a href="#inputs">Inputs</a></li>
<li><a href="#outputs">Outputs</a></li>
<li><a href="#run">How to run</a></li>
</ol>
<p><a name="quick"></a></p>
</div>
<div id="quick-start-guide" class="section level1">
<h1>1. Quick start guide</h1>
<p>The simplest way to run tugHall:</p>
<ul>
<li>Save the <strong>/tugHall/</strong> directory to the working folder;</li>
<li>Run <strong>tugHall.R</strong>.</li>
</ul>
<p>The code has its initial input parameters and input files in the <strong>/Input/</strong> folder. After the simulation the user can see results of the simulation (please, see <strong>User-Guide-Analysis</strong> for details) in the dialogue box, which will save to the <strong>/Output/</strong> and <strong>/Figures/</strong> folders. Note that the analysis procedure requires additional libraries and a higher version of R - 3.6.0.</p>
<p><a name="directories"></a></p>
</div>
<div id="structure-of-directories" class="section level1">
<h1>2. Structure of directories</h1>
<div id="root-directory" class="section level3">
<h3>Root directory:</h3>
<p><strong>User-Guide-tugHall.Rmd</strong> - user guide for simulation in the Rmd format.</p>
<p><strong>User-Guide-tugHall.html</strong> - user guide for simulation in the html format.</p>
<p><strong>User-Guide-Analysis.Rmd</strong> - user guide for analysis and report generation in the Rmd format.</p>
<p><strong>User-Guide-Analysis.html</strong> - user guide analysis and report generation in the html format.</p>
<p>dir <strong>/tugHall/</strong> - directory that contains the program.</p>
<p><br /></p>
</div>
<div id="tughall-directory" class="section level3">
<h3><strong>/tugHall/</strong> directory:</h3>
<p><strong>tugHall.R</strong> - program to run a simulation and define the parameters.</p>
<p>dir <strong>/Code/</strong> - folder with the code and the function library.</p>
<p>dir <strong>/Input/</strong> - folder with the input files.</p>
<p>dir <strong>/Output/</strong> - folder with the output files.</p>
<p>dir <strong>/Figures/</strong> - folder with the plot figures.</p>
<p><br /></p>
</div>
<div id="code-directory" class="section level3">
<h3><strong>/Code/</strong> directory:</h3>
<p><strong>CanSim.bib, pic_lic.jpg</strong> - files necessary files for the user guide.</p>
<p><strong>tugHall_functions.R</strong> - file that contains the functions for the simulation / core of program.</p>
<p><strong>Analysis.R</strong> - file to analyze the results of a simulation and plot figures.</p>
<p><strong>Functions.R</strong> - file with the functions for the analysis of results.</p>
<p><br /></p>
</div>
<div id="input-directory" class="section level3">
<h3><strong>/Input/</strong> directory:</h3>
<p><strong>cellinit.txt</strong> - file with a list of initial cells with/without destroyed genes.</p>
<p><strong>gene_cds2.txt</strong> - file with hallmark variables and weights.</p>
<p><br /></p>
</div>
<div id="output-directory" class="section level3">
<h3><strong>/Output/</strong> directory:</h3>
<p><strong>cellout.txt</strong> - file with simulation output.</p>
<p><strong>geneout.txt</strong> - file with information about hallmark variables and the weights.</p>
<p><strong>log.txt</strong> - file with information about all parameters.</p>
<p><strong>Weights.txt</strong> - file with information about weights between hallmarks and genes.</p>
<p><strong>Order_of_dysfunction.txt</strong> - see <strong>USER-GUIDE-Analysis</strong>.</p>
<p><strong>VAF.txt</strong> - see <strong>USER-GUIDE-Analysis</strong>.</p>
<p><br /></p>
</div>
<div id="figures-directory" class="section level3">
<h3><strong>/Figures/</strong> directory</h3>
<p>In the <strong>/Figures/</strong> directory there are figures in *.jpg format, which appear after the analysis of the simulation results. See <strong>USER-GUIDE-Analysis</strong>. :</p>
<p><a name="inputs"></a></p>
</div>
</div>
<div id="inputs" class="section level1">
<h1>3. Inputs</h1>
<div id="input-of-hallmark-variables-and-gene-weights" class="section level2">
<h2>Input of hallmark variables and gene weights</h2>
<p>The file <strong>tugHall/Input/gene_cds2.txt</strong> defines the halmark variables and weights (only first 10 lines are presented here):</p>
<table>
<caption><strong>Table 1. Input file for genes.</strong> Example of input file for hallmarks and weights in the file <em><strong>tugHall/Input/gene_cds2.txt</strong></em>.</caption>
<thead>
<tr class="header">
<th align="center">Genes</th>
<th align="center">length CDS</th>
<th align="center">Hallmark</th>
<th align="center">Suppressor or Oncogene</th>
<th align="center">Weights</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">APC</td>
<td align="center">8532</td>
<td align="center">apoptosis</td>
<td align="center">s</td>
<td align="center">0.1111111</td>
</tr>
<tr class="even">
<td align="center">APC</td>
<td align="center">8532</td>
<td align="center">growth</td>
<td align="center">s</td>
<td align="center">0.1666667</td>
</tr>
<tr class="odd">
<td align="center">APC</td>
<td align="center">8532</td>
<td align="center">invasion</td>
<td align="center">s</td>
<td align="center">0.2857143</td>
</tr>
<tr class="even">
<td align="center">KRAS</td>
<td align="center">567</td>
<td align="center">apoptosis</td>
<td align="center">o</td>
<td align="center">0.3333333</td>
</tr>
<tr class="odd">
<td align="center">KRAS</td>
<td align="center">567</td>
<td align="center">growth</td>
<td align="center">o</td>
<td align="center">0.3333333</td>
</tr>
<tr class="even">
<td align="center">KRAS</td>
<td align="center">567</td>
<td align="center">immortalization</td>
<td align="center">o</td>
<td align="center">0.5714286</td>
</tr>
<tr class="odd">
<td align="center">KRAS</td>
<td align="center">567</td>
<td align="center">angiogenesis</td>
<td align="center">o</td>
<td align="center">0.4285714</td>
</tr>
<tr class="even">
<td align="center">KRAS</td>
<td align="center">567</td>
<td align="center">invasion</td>
<td align="center">o</td>
<td align="center">0.1428571</td>
</tr>
<tr class="odd">
<td align="center">TP53</td>
<td align="center">1182</td>
<td align="center">apoptosis</td>
<td align="center">s</td>
<td align="center">0.1111111</td>
</tr>
<tr class="even">
<td align="center">TP53</td>
<td align="center">1182</td>
<td align="center">growth</td>
<td align="center">s</td>
<td align="center">0.1666667</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li><p><strong>Genes</strong> - name of gene, e.g., TP53, KRAS. The names must be typed carefully. The program detects all the unique gene names.</p></li>
<li><p><strong>length CDS</strong> - length of CDS for each gene, e.g., 2724, 10804.</p></li>
<li><strong>Hallmark</strong> - hallmark name, e.g., “apoptosis”. Available names:</li>
</ol>
<ul>
<li>apoptosis</li>
<li>immortalization</li>
<li>growth</li>
<li>anti-growth</li>
<li>angiogenesis</li>
<li>invasion</li>
</ul>
<p>Note that “growth” and “anti-growth” are related to the single hallmark “growth/anti-growth”. Note that “invasion” is related to “invasion/metastasis” hallmark.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Suppressor or oncogene.</strong> - Distinction of oncogene/suppressor:</li>
</ol>
<ul>
<li>o: oncogene</li>
<li>s: suppressor</li>
<li>?: unknown (will be randomly assigned)</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Weights</strong> - Hallmark weights for genes, e.g., 0.333 and 0.5. For each hallmark, the program checks the summation of all the weights. If it is not equal to 1, then the program normalizes it to reach unity. Note that, if the gene belongs to more than one hallmark type, it must be separated into separate lines.</li>
</ol>
<hr />
<p>After that, the program defines all the weights, and all the <strong>unknown weights</strong> are set equal to 0. Program performs normalization so that the sum of all weights should be equal to 1 for each column. The <strong>tugHall/Output/Weights.txt</strong> file saves these final input weights for the simulation. Only the first 10 lines are presented here:</p>
<table>
<caption><strong>Table 2. Weights for hallmarks.</strong> Example of weights for hallmarks and genes from <em><strong>tugHall/Output/Weights.txt</strong></em> file. Unknown values equal 0.</caption>
<thead>
<tr class="header">
<th align="center">Genes</th>
<th align="center">Apoptosis, <span class="math inline">\(H_a\)</span></th>
<th align="center">Angiogenesis, <span class="math inline">\(H_b\)</span></th>
<th align="center">Growth / Anti-growth, <span class="math inline">\(H_d\)</span></th>
<th align="center">Immortalization, <span class="math inline">\(H_i\)</span></th>
<th align="center">Invasion / Metastasis, <span class="math inline">\(H_{im}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">APC</td>
<td align="center">0.1590909</td>
<td align="center">0.0000000</td>
<td align="center">0.1666667</td>
<td align="center">0.0000000</td>
<td align="center">0.2195122</td>
</tr>
<tr class="even">
<td align="center">KRAS</td>
<td align="center">0.4772727</td>
<td align="center">0.4285714</td>
<td align="center">0.3333333</td>
<td align="center">0.5714286</td>
<td align="center">0.1097561</td>
</tr>
<tr class="odd">
<td align="center">TP53</td>
<td align="center">0.1590909</td>
<td align="center">0.4285714</td>
<td align="center">0.1666667</td>
<td align="center">0.4285714</td>
<td align="center">0.3292683</td>
</tr>
<tr class="even">
<td align="center">PIK3CA</td>
<td align="center">0.2045455</td>
<td align="center">0.1428571</td>
<td align="center">0.3333333</td>
<td align="center">0.0000000</td>
<td align="center">0.3414634</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li><p><strong>Genes</strong> - name of genes.</p></li>
<li><p><strong>Apoptosis, <span class="math inline">\(H_a\)</span></strong> - weights of hallmark “Apoptosis”.</p></li>
<li><p><strong>Angiogenesis, <span class="math inline">\(H_b\)</span></strong> - weights of hallmark “Angiogenesis”.</p></li>
<li><p><strong>Growth / Anti-growth, <span class="math inline">\(H_d\)</span></strong> - weights of hallmark “Growth / Anti-growth”.</p></li>
<li><p><strong>Immortalization, <span class="math inline">\(H_i\)</span></strong> - weights of hallmark “Immortalization”.</p></li>
<li><p><strong>Invasion / Metastasis, <span class="math inline">\(H_{im}\)</span></strong> - weights of hallmark “Invasion / Metastasis”.</p></li>
</ol>
<hr />
</div>
<div id="input-the-probabilities" class="section level2">
<h2>Input the probabilities</h2>
<p>The input of the probabilities used in the model is possible in the code for parameter value settings, <strong>“tugHall.R”</strong>:</p>
<table>
<thead>
<tr class="header">
<th align="left">Probability variable and value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>E0 &lt;- 2E-4</strong></td>
<td align="left">Parameter <span class="math inline">\(E0\)</span> in the division probability</td>
</tr>
<tr class="even">
<td align="left"><strong>F0 &lt;- 1E0</strong></td>
<td align="left">Parameter <span class="math inline">\(F0\)</span> in the division probability</td>
</tr>
<tr class="odd">
<td align="left"><strong>m &lt;- 1E-6</strong></td>
<td align="left">Mutation probability <span class="math inline">\(m'\)</span></td>
</tr>
<tr class="even">
<td align="left"><strong>uo &lt;- 0.5</strong></td>
<td align="left">Oncogene mutation probability <span class="math inline">\(u_o\)</span></td>
</tr>
<tr class="odd">
<td align="left"><strong>us &lt;- 0.5</strong></td>
<td align="left">Suppressor mutation probability <span class="math inline">\(u_s\)</span></td>
</tr>
<tr class="even">
<td align="left"><strong>s &lt;- 10</strong></td>
<td align="left">Parameter in the sigmoid function <span class="math inline">\(s\)</span></td>
</tr>
<tr class="odd">
<td align="left"><strong>k &lt;- 0.1</strong></td>
<td align="left">Environmental death probability <span class="math inline">\(k'\)</span></td>
</tr>
<tr class="even">
<td align="left"><img width="250/"></td>
<td align="left"><img width="270/"></td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="filename-input" class="section level2">
<h2>Filename input</h2>
<p>Also in the code <strong>“tugHall.R”</strong> user can define names of input and output files, and additional parameters of simulation:</p>
<table style="width:14%;">
<colgroup>
<col width="6%"></col>
<col width="6%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Variables and file names</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>genefile &lt;- ‘gene_cds2.txt’</strong></td>
<td align="left">File with information about weights</td>
</tr>
<tr class="even">
<td align="left"><strong>cellfile &lt;- ‘cellinit.txt’</strong></td>
<td align="left">Initial Cells</td>
</tr>
<tr class="odd">
<td align="left"><strong>geneoutfile &lt;- ‘geneout.txt’</strong></td>
<td align="left">Gene Out file with hallmarks</td>
</tr>
<tr class="even">
<td align="left"><strong>celloutfile &lt;- ‘cellout.txt’</strong></td>
<td align="left">Output information of simulation</td>
</tr>
<tr class="odd">
<td align="left"><strong>logoutfile &lt;- ‘log.txt’</strong></td>
<td align="left">Log file to save the input information of simulation</td>
</tr>
<tr class="even">
<td align="left"><strong>censore_n &lt;- 30000 </strong></td>
<td align="left">Max cell number where the program forcibly stops</td>
</tr>
<tr class="odd">
<td align="left"><strong>censore_t &lt;- 200</strong></td>
<td align="left">Max time where the program forcibly stops</td>
</tr>
<tr class="even">
<td align="left"><img width="200/"></td>
<td align="left"><img width="350/"></td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="input-of-the-initial-cells" class="section level2">
<h2>Input of the initial cells</h2>
<p>The initial states of cells are defined in <strong>“tugHall/Input/cellinit.txt”</strong> file:</p>
<table>
<thead>
<tr class="header">
<th align="left">Cell ID</th>
<th align="left">List of mutated genes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">“”</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">“APC”</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">“APC, KRAS”</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">“KRAS”</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">“TP53, KRAS”</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
</tr>
<tr class="odd">
<td align="left">1000</td>
<td align="left">“”</td>
</tr>
<tr class="even">
<td align="left"><img width="50/"></td>
<td align="left"><img width="150/"></td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li><p><strong>Cell ID</strong> - ID of cell, e.g., 1, 324.</p></li>
<li><p><strong>List of mutated genes</strong> - list of mutated genes for each cell, e.g. “”, “KRAS, APC”. The values are comma separated. The double quotes (“”) indicate a cell without mutations.</p></li>
</ol>
<hr />
<p><a name="outputs"></a></p>
</div>
</div>
<div id="outputs" class="section level1">
<h1>4. Outputs</h1>
<p>The output data consists of several files after the simulation. The “log.txt” and “geneout.txt” files contain the input information about variables and gene names. “Weights.txt” has information about the weights of genes for hallmarks (Please refer the section <a href="#inputs">“Inputs”</a>). “Cellout.txt” has information about the dynamics of cell evolution and all variables.</p>
<div id="log.txt-file" class="section level2">
<h2>“log.txt” file</h2>
<p>The file <strong>“log.txt”</strong> contains information about probabilities and file names. These variables are explained in the <a href="#inputs">“Inputs”</a>.</p>
<table>
<caption><strong>Table 3. log.txt file.</strong> Example of log.txt file.</caption>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">genefile</td>
<td align="center">Input/gene_cds2.txt</td>
</tr>
<tr class="even">
<td align="center">cellfile</td>
<td align="center">Input/cellinit.txt</td>
</tr>
<tr class="odd">
<td align="center">geneoutfile</td>
<td align="center">Output/geneout.txt</td>
</tr>
<tr class="even">
<td align="center">celloutfile</td>
<td align="center">Output/cellout.txt</td>
</tr>
<tr class="odd">
<td align="center">logoutfile</td>
<td align="center">Output/log.txt</td>
</tr>
<tr class="even">
<td align="center">E</td>
<td align="center">5e-04</td>
</tr>
<tr class="odd">
<td align="center">F</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">m</td>
<td align="center">1e-05</td>
</tr>
<tr class="odd">
<td align="center">uo</td>
<td align="center">0.5</td>
</tr>
<tr class="even">
<td align="center">us</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="center">s</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">k</td>
<td align="center">0.1</td>
</tr>
<tr class="odd">
<td align="center">censore_n</td>
<td align="center">30000</td>
</tr>
<tr class="even">
<td align="center">censore_t</td>
<td align="center">100</td>
</tr>
</tbody>
</table>
</div>
<div id="geneout.txt-file" class="section level2">
<h2>“geneout.txt” file</h2>
<p>The file <strong>“geneout.txt”</strong> contains input information about the weights that connect the hallmarks and genes, which are defined by the user. These variables also are explained in the <a href="#inputs">“Inputs”</a>.</p>
<table>
<caption><strong>Table 4. geneout.txt file.</strong> Given below is an example of the geneout.txt file.</caption>
<thead>
<tr class="header">
<th align="center">Gene_name</th>
<th align="center">Hallmark_name</th>
<th align="center">Weight</th>
<th align="center">Suppressor_or_oncogene</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">APC</td>
<td align="center">apoptosis</td>
<td align="center">0.1590909</td>
<td align="center">s</td>
</tr>
<tr class="even">
<td align="center">KRAS</td>
<td align="center">apoptosis</td>
<td align="center">0.4772727</td>
<td align="center">o</td>
</tr>
<tr class="odd">
<td align="center">TP53</td>
<td align="center">apoptosis</td>
<td align="center">0.1590909</td>
<td align="center">s</td>
</tr>
<tr class="even">
<td align="center">PIK3CA</td>
<td align="center">apoptosis</td>
<td align="center">0.2045455</td>
<td align="center">o</td>
</tr>
<tr class="odd">
<td align="center">KRAS</td>
<td align="center">immortalization</td>
<td align="center">0.5714286</td>
<td align="center">o</td>
</tr>
<tr class="even">
<td align="center">TP53</td>
<td align="center">immortalization</td>
<td align="center">0.4285714</td>
<td align="center">s</td>
</tr>
<tr class="odd">
<td align="center">APC</td>
<td align="center">growth|anti-growth</td>
<td align="center">0.1666667</td>
<td align="center">s</td>
</tr>
<tr class="even">
<td align="center">KRAS</td>
<td align="center">growth|anti-growth</td>
<td align="center">0.3333333</td>
<td align="center">o</td>
</tr>
<tr class="odd">
<td align="center">TP53</td>
<td align="center">growth|anti-growth</td>
<td align="center">0.1666667</td>
<td align="center">s</td>
</tr>
<tr class="even">
<td align="center">PIK3CA</td>
<td align="center">growth|anti-growth</td>
<td align="center">0.3333333</td>
<td align="center">o</td>
</tr>
</tbody>
</table>
</div>
<div id="cellout.txt-file" class="section level2">
<h2>“cellout.txt” file</h2>
<p>The file <strong>“cellout.txt”</strong> contains the results of the simulation and includes the evolution data: all the output data for each cell at each timestep (only the first 10 lines are presented):</p>
<table>
<caption><strong>Table 5. Output data.</strong> Example of output data for all cells. The names of columns are related to the description in the Tables 1,2 and <em>USER-GUIDE-Analysis</em>’s figures.</caption>
<thead>
<tr class="header">
<th align="center">Time</th>
<th align="center">AvgOrIndx</th>
<th align="center">ID</th>
<th align="center">ParentID.Birthday</th>
<th align="center">c.</th>
<th align="center">d.</th>
<th align="center">i.</th>
<th align="center">im.</th>
<th align="center">a.</th>
<th align="center">k.</th>
<th align="center">E.</th>
<th align="center">N</th>
<th align="center">Nmax.</th>
<th align="center">M</th>
<th align="center">Ha</th>
<th align="center">Him</th>
<th align="center">Hi</th>
<th align="center">Hd</th>
<th align="center">Hb</th>
<th align="center">type</th>
<th align="center">mut_den</th>
<th align="center">PosDriver.APC</th>
<th align="center">PosDriver.KRAS</th>
<th align="center">PosDriver.TP53</th>
<th align="center">PosDriver.PIK3CA</th>
<th align="center">PosPasngr.APC</th>
<th align="center">PosPasngr.KRAS</th>
<th align="center">PosPasngr.TP53</th>
<th align="center">PosPasngr.PIK3CA</th>
<th align="center">Clone.number</th>
<th align="center">Passengers.Clone.number</th>
<th align="center">Mix.Clone.number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">avg</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">5</td>
<td align="center">5</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">7</td>
<td align="center">7</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">9</td>
<td align="center">9</td>
<td align="center">0:0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.0066929</td>
<td align="center">0.1</td>
<td align="center">5e-04</td>
<td align="center">1000</td>
<td align="center">2000</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li><strong>Time</strong> - the time step, e.g., 1, 50.</li>
<li><strong>AvgOrIndx</strong> - “avg” or “index”: “avg” is for a line with averaged values across different (index) lines at the same time step; “index” shows the cell’s index at the current time step, e.g., avg, 4,7.</li>
<li><strong>ID</strong> - the unique ID of cell, e.g., 1, 50.</li>
<li><strong>ParentID.Birthday</strong> - the first number is the parent ID, the second number is the birthday time step, e.g., 0:0, 45:5.</li>
<li><strong>c</strong> - the counter of cell divisions for the cell.</li>
<li><strong>d</strong> - the probability of division for the cell, e.g., 0.1, 0.8.</li>
<li><strong>i</strong> - the probability of immortalization for the cell, e.g., 0.1, 0.8.</li>
<li><strong>im</strong> - the probability of invasion/metastasis for the cell, e.g., 0.1, 0.8.</li>
<li><strong>a</strong> - the probability of apoptosis for the cell, e.g., 0.1, 0.8.</li>
<li><strong>k</strong> - the probability of death due to the environment, e.g., 0.1, 0.8.</li>
<li><strong>E</strong> - the E coefficient for the function of the division probability, e.g., 10^4, 10^5.</li>
<li><strong>N</strong> - the number of primary tumor cells at this time step, e.g., 134, 5432.</li>
<li><strong>Nmax</strong> - the theoretically maximal number of primary tumor cells, e.g., 10000, 5000.</li>
<li><strong>M</strong> - the number of metastasis cells at this time step, e.g., 16, 15439.</li>
<li><strong>Ha</strong> - the value of the hallmark “Apoptosis” for the cell, e.g., 0.1, 0.4444.</li>
<li><strong>Him</strong> - the value of the hallmark “Invasion / Metastasis” for the cell, e.g., 0.1, 0.4444.</li>
<li><strong>Hi</strong> - the value of the hallmark “Immortalization” for the cell, e.g., 0.1, 0.4444.</li>
<li><strong>Hd</strong> - the value of the hallmark “Growth / Anti-growth” for the cell, e.g., 0.1, 0.4444 .</li>
<li><strong>Hb</strong> - the value of the hallmark “Angiogenesis” for the cell, e.g., 0.1, 0.4444 .</li>
<li><strong>type</strong> - the type of the cell: “0” is primary tumor cell, “1” is the metastatic cell, e.g., 0, 1.</li>
<li><strong>mut_den</strong> - the density of mutations (tumor mutation burden) for the cell, e.g., 0, 0.32.</li>
</ol>
<p>The columns from 22 to 25 are related to names in the form <strong>PosDriver. <em>gene name</em></strong>, where <strong><em>gene name</em></strong> is related to user defined genes. The number of columns equals the number of the genes. These columns show the position(s) of driver mutation(s) in a gene: the first number is the mutational site on the gene and the second number is the time step of the mutation, e.g., 3493:4, 4531:34.</p>
<ol start="22" style="list-style-type: decimal">
<li><strong>PosDriver.(Gene_1=“APC”)</strong> - for the first gene.</li>
<li><strong>PosDriver.(Gene_2=“KRAS”)</strong> - for the second gene.</li>
<li><strong>PosDriver.(Gene_…)</strong> - …</li>
<li><strong>PosDriver.(Gene_last=“PIK3CA”)</strong> - for the last gene.</li>
</ol>
<p>The columns from 26 to 29 are related to names in the form <strong>PosPassngr. <em>gene name</em></strong>, where <strong><em>gene name</em></strong> is related to user defined genes. The number of columns equals the number of the genes. These columns show the position(s) of <strong>passenger</strong> mutation(s) in a gene: the first number is the mutational site on the gene and the second number is the time step of the mutation, e.g., 8952:43, 531:4.</p>
<ol start="26" style="list-style-type: decimal">
<li><strong>PosPassngr.(Gene_1=“APC”)</strong> - for the first gene.</li>
<li><strong>PosPassngr.(Gene_2=“KRAS”)</strong> - for the second gene.</li>
<li><strong>PosPassngr.(Gene_…)</strong> - …</li>
<li><strong>PosPassngr.(Gene_last=“PIK3CA”)</strong> - for the last gene.</li>
</ol>
<p><br /></p>
<ol start="30" style="list-style-type: decimal">
<li><strong>Clone.number</strong> - the clone number is calculated from the binary code of driver mutations. If a gene is mutated, then its binary code value is 1, and if not, it is 0. For example, the cells have only 4 genes in simulation, so “Clone.number” can have binary numbers from 0000 to 1111, which is related decimal numbers from 0 to 15, e.g., 15, 4.</li>
<li><strong>Passengers.Clone.number</strong> - same as for “Clone.number”, but for passenger mutations, e.g., 15, 4.</li>
<li><strong>Mix.Clone.number</strong> - same as for “Clone.number”, but for passenger and driver mutations together. In this case, the length of the binary number is two times larger than for the driver case, e.g., 35, 16.</li>
</ol>
<hr />
<p><a name="run"></a></p>
</div>
</div>
<div id="how-to-run" class="section level1">
<h1>5. How to run</h1>
<p>In order to make the simulation, please follow the procedure:</p>
<ol style="list-style-type: decimal">
<li><p>Copy <strong>/tugHall/</strong> directory into the working directory.</p></li>
<li><p>CD to the <strong>/tugHall/</strong> directory.</p></li>
<li><p>Run the <strong>tugHall.R</strong> file, using the command line like</p></li>
</ol>
<p><code>R --vanilla &lt; tugHall.R</code></p>
<p>or using the line by line procedure in <strong>R Studio</strong>. In this case we have:</p>
<ul>
<li><strong><code>load library(stringr)</code></strong> and <strong><code>source(file = &quot;Code/tugHall_functions.R&quot;)</code></strong>;</li>
<li>create the Output and Figures directories, if needed;</li>
<li>define the simulation parameters;</li>
<li>make the input file for initial cells, if needed;</li>
<li>run the <em>model()</em> function to simulate;</li>
<li>run <strong><code>source(&quot;Code/Analysis.R&quot;)</code></strong> in order to analyze the results and plot the figures in the dialogue box (see <strong>User-Guide-Analysis</strong>).</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>To make a report of the simulation, please, use the <strong>User-Guide-Analysis.RMD</strong>. In the User-Guide-Analysis.RMD, commands are embeded to include files under Output/ and Figure/. So, after analysis with tugHall, you can generate analysis report automatically from the User-Guide-Analysis.RMD. with knitr or something else. For more details, please, see “Writing reproducible reports in R” on the github (<a href="https://nicercode.github.io/guides/reports/" class="uri">https://nicercode.github.io/guides/reports/</a>). For more details, please, see <strong>User-Guide-Analysis</strong>.</li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
